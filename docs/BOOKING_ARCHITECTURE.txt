================================================================================
                    FIILAR BOOKING PLATFORM - COMPLETE ARCHITECTURE
================================================================================
                         Version: 1.0 | Date: November 27, 2025
================================================================================


TABLE OF CONTENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.  System Overview
2.  User Roles & Permissions
3.  Complete Booking Flow (End-to-End)
4.  Data Models
5.  API Endpoints Reference
6.  Security Implementation
7.  Financial Flow (Escrow System)
8.  Notification System
9.  Handshake Verification Protocol
10. Dispute Resolution
11. Status Transitions
12. Configuration Management
13. Database Schema (localStorage â†’ Backend)
14. Error Handling
15. Future Considerations


================================================================================
1. SYSTEM OVERVIEW
================================================================================

Fiilar is a space rental marketplace connecting Guests with Hosts for:
- Hourly rentals (studios, meeting rooms, co-working spaces)
- Nightly/Daily rentals (apartments, vacation homes, event venues)

TECH STACK
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Frontend:     React 18 + TypeScript + Vite
State:        React Context + localStorage (mock backend)
Styling:      Tailwind CSS
Monorepo:     pnpm workspaces
Libraries:    
  - @fiilar/types      â†’ Shared TypeScript interfaces
  - @fiilar/storage    â†’ Data persistence layer
  - @fiilar/escrow     â†’ Payment & escrow management
  - @fiilar/notifications â†’ In-app notifications
  - @fiilar/booking    â†’ Booking logic & availability
  - @fiilar/messaging  â†’ Chat between users
  - @fiilar/reviews    â†’ Rating & review system
  - @fiilar/kyc        â†’ Identity verification
  - @fiilar/admin      â†’ Admin panel components
  - @fiilar/ui         â†’ Shared UI components


================================================================================
2. USER ROLES & PERMISSIONS
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ROLE       â”‚ PERMISSIONS                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GUEST      â”‚ Browse listings only (not logged in)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ USER       â”‚ - Browse & book listings                                      â”‚
â”‚            â”‚ - Manage bookings (view, cancel, modify if allowed)           â”‚
â”‚            â”‚ - Add funds to wallet                                         â”‚
â”‚            â”‚ - View transaction history                                    â”‚
â”‚            â”‚ - Message hosts                                               â”‚
â”‚            â”‚ - Leave reviews                                               â”‚
â”‚            â”‚ - Save favorites                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HOST       â”‚ - All USER permissions                                        â”‚
â”‚            â”‚ - Create & manage listings                                    â”‚
â”‚            â”‚ - Accept/Reject/Modify booking requests                       â”‚
â”‚            â”‚ - Verify guest handshake codes                                â”‚
â”‚            â”‚ - View earnings & payouts                                     â”‚
â”‚            â”‚ - Set availability calendar                                   â”‚
â”‚            â”‚ - Respond to reviews                                          â”‚
â”‚            â”‚ - KYC verification required                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ADMIN      â”‚ - All HOST permissions                                        â”‚
â”‚            â”‚ - Approve/Reject listings                                     â”‚
â”‚            â”‚ - Verify KYC documents                                        â”‚
â”‚            â”‚ - Resolve disputes                                            â”‚
â”‚            â”‚ - View platform financials                                    â”‚
â”‚            â”‚ - Manage escrow releases                                      â”‚
â”‚            â”‚ - Access audit logs                                           â”‚
â”‚            â”‚ - System health checks                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
3. COMPLETE BOOKING FLOW (END-TO-END)
================================================================================

VISUAL FLOW DIAGRAM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         BOOKING LIFECYCLE                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ğŸ‘¤ GUEST/USER                  ğŸ  HOST                    ğŸ‘‘ ADMIN
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1. DISCOVERY    â”‚
    â”‚ Browse listings â”‚
    â”‚ Search/Filter   â”‚
    â”‚ View details    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 2. SELECTION    â”‚
    â”‚ Pick date/time  â”‚
    â”‚ Select hours    â”‚  â†â”€â”€ Hourly: Pick specific hours (e.g., 9,10,11)
    â”‚ Choose add-ons  â”‚      Nightly: Pick check-in date + duration
    â”‚ Guest count     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 3. PRICING      â”‚
    â”‚ CALCULATION     â”‚
    â”‚                 â”‚
    â”‚ Base Price      â”‚  â†â”€â”€ $X per hour OR $X per night
    â”‚ + Extra Guests  â”‚  â†â”€â”€ (guestCount - includedGuests) Ã— pricePerExtra
    â”‚ + Add-ons       â”‚  â†â”€â”€ Sum of selected add-on prices
    â”‚ = Subtotal      â”‚
    â”‚ + Service Fee   â”‚  â†â”€â”€ 10% of subtotal (BOOKING_CONFIG)
    â”‚ + Caution Fee   â”‚  â†â”€â”€ Fixed per listing (refundable deposit)
    â”‚ = TOTAL         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 4. VALIDATION   â”‚
    â”‚                 â”‚
    â”‚ âœ“ Price check   â”‚  â†â”€â”€ validateBookingPriceDetailed()
    â”‚ âœ“ Slot check    â”‚  â†â”€â”€ checkSlotAvailability()
    â”‚ âœ“ Duplicate     â”‚  â†â”€â”€ checkBookingIdempotency()
    â”‚ âœ“ Integrity     â”‚  â†â”€â”€ validateBookingIntegrity()
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 5. PAYMENT      â”‚      â”‚ ESCROW HOLDS    â”‚
    â”‚                 â”‚â”€â”€â”€â”€â”€â–ºâ”‚ FUNDS           â”‚
    â”‚ Wallet or Card  â”‚      â”‚                 â”‚
    â”‚                 â”‚      â”‚ Guest Payment   â”‚
    â”‚                 â”‚      â”‚ Service Fee     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                        â”‚
             â–¼                        â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚ 6. BOOKING      â”‚               â”‚
    â”‚ CREATED         â”‚               â”‚
    â”‚                 â”‚               â”‚
    â”‚ Status: PENDING â”‚               â”‚
    â”‚ Guest Code: XXX â”‚               â”‚
    â”‚ Host Code: XXX  â”‚               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
             â”‚                        â”‚
             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚    â”‚
             â–¼    â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ NOTIFICATION    â”‚
             â”‚ SENT TO HOST    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  ğŸ  HOST RECEIVES
             â”‚                 â”‚                   "New Booking Request"
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ 7. HOST DECISION  â”‚
                              â”‚                   â”‚
                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                              â”‚ â”‚   ACCEPT      â”‚ â”‚â”€â”€â”€â–º Status: CONFIRMED
                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     Guest notified
                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                              â”‚ â”‚   REJECT      â”‚ â”‚â”€â”€â”€â–º Status: CANCELLED
                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     Full refund processed
                              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     Guest notified
                              â”‚ â”‚ ALLOW MODIFY  â”‚ â”‚â”€â”€â”€â–º modificationAllowed: true
                              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     Guest can edit booking
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                      â”‚ (if ACCEPTED)
                                      â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 8. CONFIRMED    â”‚       â”‚ Host prepares     â”‚
    â”‚ BOOKING         â”‚       â”‚ property          â”‚
    â”‚                 â”‚       â”‚                   â”‚
    â”‚ Guest sees:     â”‚       â”‚ Status: CONFIRMED â”‚
    â”‚ - Guest Code    â”‚       â”‚                   â”‚
    â”‚ - Booking date  â”‚       â”‚                   â”‚
    â”‚ - Property info â”‚       â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚  (On booking date)
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 9. ARRIVAL      â”‚       â”‚ 10. HANDSHAKE     â”‚
    â”‚                 â”‚       â”‚ VERIFICATION      â”‚
    â”‚ Guest shows     â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
    â”‚ Guest Code      â”‚       â”‚ Host enters code  â”‚
    â”‚                 â”‚       â”‚ OR scans QR       â”‚
    â”‚                 â”‚       â”‚                   â”‚
    â”‚                 â”‚       â”‚ If valid:         â”‚
    â”‚                 â”‚       â”‚ handshakeStatus:  â”‚
    â”‚                 â”‚       â”‚   VERIFIED        â”‚
    â”‚                 â”‚       â”‚ Status: STARTED   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 11. SESSION     â”‚       â”‚ Booking in        â”‚
    â”‚                 â”‚       â”‚ progress...       â”‚
    â”‚ Guest uses      â”‚       â”‚                   â”‚
    â”‚ the space       â”‚       â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚  (After checkout)
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 12. COMPLETION                              â”‚
    â”‚                                             â”‚
    â”‚ Status: COMPLETED                           â”‚
    â”‚                                             â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚ â”‚ 48-HOUR ESCROW HOLD                     â”‚ â”‚
    â”‚ â”‚                                         â”‚ â”‚
    â”‚ â”‚ Funds held for dispute window           â”‚ â”‚
    â”‚ â”‚ escrowReleaseDate = checkoutTime + 48h  â”‚ â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 13. AUTO-RELEASE                            â”‚
    â”‚                                             â”‚
    â”‚ Scheduler checks every minute               â”‚
    â”‚ If escrowReleaseDate <= now:                â”‚
    â”‚   â†’ Release funds to host                   â”‚
    â”‚   â†’ paymentStatus: 'Released'               â”‚
    â”‚   â†’ Create HOST_PAYOUT transaction          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ALTERNATIVE PATHS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

A. BOOKING EXPIRY (Host doesn't respond)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Status: PENDING â”‚
   â”‚ for > 1 hour    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ AUTO-EXPIRY     â”‚
   â”‚                 â”‚
   â”‚ Status: CANCELLEDâ”‚
   â”‚ cancelledBy:    â”‚
   â”‚   'system'      â”‚
   â”‚ Full refund     â”‚
   â”‚ processed       â”‚
   â”‚ Guest notified  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


B. GUEST CANCELLATION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Guest requests  â”‚
   â”‚ cancellation    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CANCELLATION    â”‚
   â”‚ POLICY CHECK    â”‚
   â”‚                 â”‚
   â”‚ FLEXIBLE:       â”‚  â†â”€â”€ Full refund if 24h+ before
   â”‚ MODERATE:       â”‚  â†â”€â”€ Full refund if 5 days+ before
   â”‚ STRICT:         â”‚  â†â”€â”€ 50% refund
   â”‚ NON_REFUNDABLE: â”‚  â†â”€â”€ No refund
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Process refund  â”‚
   â”‚ (if applicable) â”‚
   â”‚                 â”‚
   â”‚ Status:CANCELLEDâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


C. DISPUTE FLOW
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Guest or Host   â”‚
   â”‚ opens dispute   â”‚
   â”‚                 â”‚
   â”‚ disputeStatus:  â”‚
   â”‚   OPEN          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ADMIN REVIEW    â”‚
   â”‚                 â”‚
   â”‚ Evidence:       â”‚
   â”‚ - Handshake     â”‚
   â”‚   verification  â”‚
   â”‚ - Messages      â”‚
   â”‚ - Transaction   â”‚
   â”‚   history       â”‚
   â”‚ - Audit logs    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ADMIN DECISION                        â”‚
   â”‚                                       â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ â”‚ REFUND_GUEST    â”‚ â”‚ RELEASE_HOST  â”‚ â”‚
   â”‚ â”‚                 â”‚ â”‚               â”‚ â”‚
   â”‚ â”‚ Full refund to  â”‚ â”‚ Funds go to   â”‚ â”‚
   â”‚ â”‚ guest           â”‚ â”‚ host          â”‚ â”‚
   â”‚ â”‚ Status:CANCELLEDâ”‚ â”‚ Status:       â”‚ â”‚
   â”‚ â”‚                 â”‚ â”‚ COMPLETED     â”‚ â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚                                       â”‚
   â”‚ disputeStatus: RESOLVED               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
4. DATA MODELS
================================================================================

USER
â”€â”€â”€â”€
{
  id: string;                    // Unique user ID (e.g., "user_123")
  firstName: string;             // Required for dashboard access
  lastName: string;              // Required for dashboard access
  name: string;                  // Full name (auto-generated)
  email: string;                 // Primary identifier
  phone?: string;                // Optional phone
  password?: string;             // Hashed password (if email auth)
  role: Role;                    // GUEST | USER | HOST | ADMIN
  isHost: boolean;               // Quick check for host status
  createdAt: string;             // ISO timestamp
  avatar?: string;               // Profile image URL
  bio?: string;                  // User bio
  walletBalance: number;         // Current wallet balance
  emailVerified: boolean;        // Email verification status
  phoneVerified?: boolean;       // Phone verification status
  authProvider: 'email'|'google'|'phone';
  
  // Verification tokens
  verificationToken?: string;
  verificationTokenExpiry?: string;
  verificationOtp?: string;      // 6-digit code
  verificationOtpExpiry?: string;
  
  // KYC
  kycVerified?: boolean;
  kycStatus?: 'pending'|'verified'|'rejected'|'none';
  kycDocument?: string;          // Document URL
  livenessVerified?: boolean;
  identityDocument?: string;     // ID document URL
  
  // Host-specific
  badgeStatus?: 'standard'|'super_host'|'premium';
  bankDetails?: BankDetails;
  
  // User preferences
  favorites?: string[];          // Saved listing IDs
  rating?: number;               // Average rating
  reviewCount?: number;
}

LISTING
â”€â”€â”€â”€â”€â”€â”€
{
  id: string;                    // Unique listing ID
  hostId: string;                // Owner's user ID
  title: string;                 // Listing title
  description: string;           // Full description
  type: SpaceType;               // Apartment|Studio|Conference|etc.
  price: number;                 // Base price per unit
  priceUnit: BookingType;        // Hourly | Daily
  images: string[];              // Image URLs
  location: string;              // Public location (e.g., "Lekki Phase 1")
  address?: string;              // Private address (shown after booking)
  coordinates?: {lat, lng};      // Map coordinates
  status: ListingStatus;         // Draft|Pending KYC|Pending Approval|Live|Rejected
  tags: string[];                // Search tags
  
  // Availability
  availability?: Record<string, number[]>;  // "YYYY-MM-DD": [9,10,11]
  
  // Capacity & Pricing
  capacity?: number;             // Max guests
  includedGuests?: number;       // Guests included in base price
  pricePerExtraGuest?: number;   // Cost per extra guest
  cautionFee?: number;           // Refundable deposit
  
  // Features
  addOns?: ListingAddOn[];       // Optional extras
  amenities?: Amenity[];         // WiFi, Parking, etc.
  
  // Policies
  cancellationPolicy?: CancellationPolicy;
  houseRules?: string[];
  safetyItems?: string[];
  approvalTime?: string;         // "0-15 mins", "1-2 hours"
  
  // Settings
  settings?: {
    allowRecurring: boolean;     // Enable recurring bookings
    minDuration: number;         // Minimum booking duration
    instantBook: boolean;        // Skip host approval
  };
  
  requiresIdentityVerification?: boolean;
  proofOfAddress?: string;
  rejectionReason?: string;
  
  // Ratings
  rating?: number;
  reviewCount?: number;
}

BOOKING
â”€â”€â”€â”€â”€â”€â”€
{
  id: string;                    // Unique booking ID (e.g., "bk_1701234567_abc123")
  listingId: string;             // Reference to listing
  userId: string;                // Guest's user ID
  date: string;                  // Booking date (YYYY-MM-DD)
  duration: number;              // Hours or days
  hours?: number[];              // Specific hours [9,10,11] for hourly
  bookingType: BookingType;      // HOURLY | DAILY
  
  // Financials
  totalPrice: number;            // Final amount paid
  serviceFee: number;            // Platform fee (10%)
  cautionFee: number;            // Security deposit
  
  // Status
  status: 'Pending'|'Confirmed'|'Started'|'Completed'|'Cancelled'|'Reserved';
  createdAt?: string;            // When booking was created
  
  // Recurring
  groupId?: string;              // Links recurring bookings
  
  // Guest info
  guestCount?: number;
  selectedAddOns?: string[];     // Add-on IDs
  
  // Cancellation
  cancellationReason?: string;
  cancelledAt?: string;
  cancelledBy?: string;          // userId or 'system'
  refundAmount?: number;
  refundProcessed?: boolean;
  
  // Payment
  paymentStatus?: 'Pending'|'Held'|'Released'|'Refunded'|'Paid - Escrow';
  escrowReleaseDate?: string;    // When funds can be released
  transactionIds?: string[];     // Related transaction IDs
  
  // Security (Handshake Protocol)
  guestCode?: string;            // 6-char code shown to guest
  hostCode?: string;             // Code for host verification
  handshakeStatus?: 'PENDING'|'VERIFIED'|'FAILED';
  verifiedAt?: string;           // When handshake completed
  
  // Dispute
  disputeStatus?: 'NONE'|'OPEN'|'RESOLVED';
  modificationAllowed?: boolean; // Host allows guest to modify
}

ESCROW TRANSACTION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  id: string;                    // Transaction ID
  bookingId: string;             // Related booking
  type: 'GUEST_PAYMENT'|'HOST_PAYOUT'|'REFUND'|'SERVICE_FEE';
  amount: number;
  status: 'PENDING'|'COMPLETED'|'FAILED';
  paystackReference?: string;    // Payment gateway reference
  timestamp: string;
  fromUserId?: string;           // For payments
  toUserId?: string;             // For payouts
  metadata?: {
    listingId?: string;
    notes?: string;
    [key: string]: any;
  };
}

NOTIFICATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  id: string;
  userId: string;                // Recipient
  type: 'booking'|'payment'|'message'|'system';
  title: string;
  message: string;
  severity: 'info'|'warning'|'error'|'success';
  read: boolean;
  actionRequired: boolean;
  createdAt: string;
  metadata?: {
    bookingId?: string;
    link?: string;
    [key: string]: any;
  };
}


================================================================================
5. API ENDPOINTS REFERENCE
================================================================================

AUTHENTICATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST   /api/auth/login           Login with email/phone
POST   /api/auth/register        Create new account
POST   /api/auth/logout          End session
POST   /api/auth/otp/send        Send OTP code
POST   /api/auth/otp/verify      Verify OTP code
GET    /api/auth/session         Validate current session

USERS
â”€â”€â”€â”€â”€
GET    /api/users/:id            Get user profile
PUT    /api/users/:id            Update user profile
GET    /api/users/:id/wallet     Get wallet balance
POST   /api/users/:id/wallet/add Add funds to wallet
POST   /api/users/:id/wallet/withdraw  Withdraw funds
GET    /api/users/:id/favorites  Get saved listings
POST   /api/users/:id/favorites/:listingId  Toggle favorite

LISTINGS
â”€â”€â”€â”€â”€â”€â”€â”€
GET    /api/listings             Get all listings (with filters)
GET    /api/listings/:id         Get listing details
POST   /api/listings             Create new listing
PUT    /api/listings/:id         Update listing
DELETE /api/listings/:id         Delete listing
GET    /api/listings/:id/availability  Get availability calendar
PUT    /api/listings/:id/availability  Update availability
POST   /api/listings/:id/approve Admin approve listing
POST   /api/listings/:id/reject  Admin reject listing

BOOKINGS
â”€â”€â”€â”€â”€â”€â”€â”€
GET    /api/bookings             Get all bookings (filtered)
GET    /api/bookings/:id         Get booking by ID
POST   /api/bookings             Create new booking
PUT    /api/bookings/:id         Update booking
DELETE /api/bookings/:id         Cancel/delete booking
POST   /api/bookings/:id/accept  Host accepts booking
POST   /api/bookings/:id/reject  Host rejects booking
POST   /api/bookings/:id/handshake  Verify handshake code
GET    /api/bookings/code/:code  Find booking by guest code
POST   /api/bookings/:id/modify/allow  Enable modification
POST   /api/bookings/:id/dispute Open dispute

ESCROW / PAYMENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST   /api/escrow/payment       Process guest payment
POST   /api/escrow/release       Release funds to host
POST   /api/escrow/refund        Process refund
GET    /api/escrow/transactions  Get all transactions
GET    /api/escrow/financials    Get platform financials
POST   /api/escrow/dispute/resolve  Admin resolve dispute

NOTIFICATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GET    /api/notifications        Get user notifications
POST   /api/notifications        Create notification
PATCH  /api/notifications/:id/read  Mark as read
PATCH  /api/notifications/read-all  Mark all as read
DELETE /api/notifications        Clear all notifications

KYC
â”€â”€â”€
POST   /api/kyc/submit           Submit KYC documents
GET    /api/kyc/status/:userId   Get KYC status
POST   /api/kyc/verify/:userId   Admin verify KYC
POST   /api/kyc/reject/:userId   Admin reject KYC

REVIEWS
â”€â”€â”€â”€â”€â”€â”€
GET    /api/reviews/listing/:listingId  Get listing reviews
GET    /api/reviews/user/:userId  Get user reviews
POST   /api/reviews              Create review
PUT    /api/reviews/:id          Update review
DELETE /api/reviews/:id          Delete review

MESSAGING
â”€â”€â”€â”€â”€â”€â”€â”€â”€
GET    /api/conversations        Get user conversations
GET    /api/conversations/:id    Get conversation messages
POST   /api/conversations        Start new conversation
POST   /api/conversations/:id/message  Send message

ADMIN
â”€â”€â”€â”€â”€
GET    /api/admin/dashboard      Get admin dashboard data
GET    /api/admin/users          Get all users
GET    /api/admin/bookings       Get all bookings
GET    /api/admin/listings       Get all listings
GET    /api/admin/audit-log      Get audit log
GET    /api/admin/health-check   System health status


================================================================================
6. SECURITY IMPLEMENTATION
================================================================================

AUTHENTICATION SECURITY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SECURITY LAYER                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  OTP Rate Limiting                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  â€¢ Max 5 OTP attempts per identifier                                        â”‚
â”‚  â€¢ Lockout: 15 minutes after exceeded                                       â”‚
â”‚  â€¢ Auto-reset after lockout period                                          â”‚
â”‚                                                                             â”‚
â”‚  Session Management                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚  â€¢ Session expiry: 24 hours                                                 â”‚
â”‚  â€¢ Secure token generation (crypto.getRandomValues)                         â”‚
â”‚  â€¢ Device fingerprinting                                                    â”‚
â”‚  â€¢ Single active session per device                                         â”‚
â”‚                                                                             â”‚
â”‚  Password/Token Security                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚  â€¢ OTP: 6-digit cryptographically random                                    â”‚
â”‚  â€¢ OTP expiry: 3 minutes                                                    â”‚
â”‚  â€¢ Hashing: SHA-256 (async) or djb2+salt (sync)                            â”‚
â”‚  â€¢ Token length: 32 characters                                              â”‚
â”‚                                                                             â”‚
â”‚  Input Validation                                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚  â€¢ XSS prevention (sanitizeInput)                                           â”‚
â”‚  â€¢ Email format validation                                                  â”‚
â”‚  â€¢ Phone format validation (10-15 digits)                                   â”‚
â”‚  â€¢ Max string length: 1000 chars                                            â”‚
â”‚  â€¢ Dangerous pattern detection (<script>, javascript:, etc.)                â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

BOOKING SECURITY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDATION CHECKS (createSecureBooking)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. PRICE VALIDATION                                                        â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚     â€¢ Server recalculates total price                                       â”‚
â”‚     â€¢ Compares with client-submitted price                                  â”‚
â”‚     â€¢ Tolerance: $0.01 (floating point)                                     â”‚
â”‚     â€¢ Validates service fee (10%)                                           â”‚
â”‚     â€¢ Validates caution fee                                                 â”‚
â”‚     â€¢ Logs PRICE_VALIDATION_FAILED if mismatch                              â”‚
â”‚                                                                             â”‚
â”‚  2. IDEMPOTENCY CHECK                                                       â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚     â€¢ Prevents duplicate bookings                                           â”‚
â”‚     â€¢ Key: userId + listingId + date + hours                                â”‚
â”‚     â€¢ Expiry: 24 hours                                                      â”‚
â”‚     â€¢ Logs DUPLICATE_BOOKING_ATTEMPT if exists                              â”‚
â”‚                                                                             â”‚
â”‚  3. SLOT AVAILABILITY                                                       â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚     â€¢ Prevents double-booking (race condition)                              â”‚
â”‚     â€¢ Checks ALL existing bookings for conflicts                            â”‚
â”‚     â€¢ Hourly: checks hour overlaps                                          â”‚
â”‚     â€¢ Daily: checks date range overlaps                                     â”‚
â”‚     â€¢ Logs SLOT_ALREADY_BOOKED if conflict                                  â”‚
â”‚                                                                             â”‚
â”‚  4. INTEGRITY VALIDATION                                                    â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚     â€¢ Required fields: id, userId, listingId, date, totalPrice              â”‚
â”‚     â€¢ Price sanity: > 0, < 100,000,000                                      â”‚
â”‚     â€¢ Guest count: >= 1                                                     â”‚
â”‚     â€¢ Duration: >= 1                                                        â”‚
â”‚     â€¢ Hours: non-empty array for hourly                                     â”‚
â”‚     â€¢ Date: not in past                                                     â”‚
â”‚     â€¢ Logs BOOKING_INTEGRITY_FAILED if invalid                              â”‚
â”‚                                                                             â”‚
â”‚  5. STATUS TRANSITION VALIDATION                                            â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚
â”‚     â€¢ Pending â†’ Confirmed, Cancelled                                        â”‚
â”‚     â€¢ Confirmed â†’ Completed, Cancelled                                      â”‚
â”‚     â€¢ Completed â†’ (terminal, no changes)                                    â”‚
â”‚     â€¢ Cancelled â†’ (terminal, no changes)                                    â”‚
â”‚     â€¢ Logs SECURITY_VIOLATION if invalid transition                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AUDIT LOGGING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
All security events are logged to audit log:
â€¢ LOGIN / LOGOUT
â€¢ OTP_SENT / OTP_VERIFIED / OTP_FAILED
â€¢ ACCOUNT_LOCKED
â€¢ BOOKING_CREATED
â€¢ PAYMENT_PROCESSED
â€¢ ADMIN_BYPASS_ATTEMPT
â€¢ SESSION_EXPIRED
â€¢ SECURITY_VIOLATION


================================================================================
7. FINANCIAL FLOW (ESCROW SYSTEM)
================================================================================

MONEY FLOW DIAGRAM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         PAYMENT FLOW                                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    GUEST                    PLATFORM                      HOST
    â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€                      â”€â”€â”€â”€

    ğŸ’³ Payment
       â”‚
       â”‚ totalPrice = base + serviceFee + cautionFee
       â”‚
       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Pay $150     â”‚
    â”‚              â”‚
    â”‚ Base: $120   â”‚
    â”‚ Fee:  $12    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Caution: $18 â”‚           â”‚ ESCROW ACCOUNT          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                         â”‚
                               â”‚ Holds: $150             â”‚
                               â”‚                         â”‚
                               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                               â”‚ â”‚ GUEST_PAYMENT: $150 â”‚ â”‚
                               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                               â”‚ â”‚ SERVICE_FEE: $12    â”‚ â”‚
                               â”‚ â”‚ (Platform Revenue)  â”‚ â”‚
                               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                      â”‚                      â”‚
                     â–¼                      â–¼                      â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ IF COMPLETED    â”‚   â”‚ IF REJECTED     â”‚   â”‚ IF DISPUTED     â”‚
           â”‚                 â”‚   â”‚ OR EXPIRED      â”‚   â”‚                 â”‚
           â”‚ After 48 hours: â”‚   â”‚                 â”‚   â”‚ Admin decides:  â”‚
           â”‚                 â”‚   â”‚ Full refund     â”‚   â”‚                 â”‚
           â”‚ HOST_PAYOUT:    â”‚   â”‚ REFUND: $150    â”‚   â”‚ REFUND_GUEST or â”‚
           â”‚ $120 to Host    â”‚   â”‚ to Guest        â”‚   â”‚ RELEASE_TO_HOST â”‚
           â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚
           â”‚ Caution: $18    â”‚   â”‚                 â”‚   â”‚                 â”‚
           â”‚ returned or     â”‚   â”‚                 â”‚   â”‚                 â”‚
           â”‚ held for damage â”‚   â”‚                 â”‚   â”‚                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                     â”‚                     â”‚
                    â–¼                     â–¼                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ ğŸ  HOST  â”‚          â”‚ ğŸ‘¤ GUEST â”‚          â”‚ Winner   â”‚
              â”‚ receives â”‚          â”‚ receives â”‚          â”‚ receives â”‚
              â”‚ $120     â”‚          â”‚ $150     â”‚          â”‚ funds    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


TRANSACTION TYPES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type          â”‚ Description                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GUEST_PAYMENT â”‚ Guest pays for booking (total amount)                     â”‚
â”‚ SERVICE_FEE   â”‚ Platform's 10% cut (extracted from payment)               â”‚
â”‚ HOST_PAYOUT   â”‚ Host receives their portion after escrow release          â”‚
â”‚ REFUND        â”‚ Guest refunded (cancellation/rejection/dispute)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESCROW RELEASE CALCULATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

For Hourly Bookings:
  bookingEnd = bookingDate + lastHour + 1 hour
  escrowReleaseDate = bookingEnd + 48 hours

For Daily/Nightly Bookings:
  bookingEnd = checkInDate + duration days + 11:00 AM (checkout)
  escrowReleaseDate = bookingEnd + 48 hours

Example:
  Booking: Dec 1, 2025, hours [14, 15, 16] (2pm-5pm)
  bookingEnd: Dec 1, 2025 at 5:00 PM
  escrowReleaseDate: Dec 3, 2025 at 5:00 PM


================================================================================
8. NOTIFICATION SYSTEM
================================================================================

NOTIFICATION TRIGGERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EVENT                      â”‚ RECIPIENT â”‚ NOTIFICATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Booking Created            â”‚ Host      â”‚ "New booking request for [listing]"â”‚
â”‚ Booking Created            â”‚ Guest     â”‚ "Booking request sent!"            â”‚
â”‚ Host Accepts               â”‚ Guest     â”‚ "Booking confirmed!"               â”‚
â”‚ Host Rejects               â”‚ Guest     â”‚ "Booking not accepted - Refunded"  â”‚
â”‚ Booking Expired            â”‚ Guest     â”‚ "Request expired - Refunded"       â”‚
â”‚ Modification Allowed       â”‚ Guest     â”‚ "Host invited you to modify"       â”‚
â”‚ Handshake Verified         â”‚ Both      â”‚ "Check-in confirmed!"              â”‚
â”‚ Funds Released             â”‚ Host      â”‚ "Payment released to your account" â”‚
â”‚ Dispute Opened             â”‚ Both      â”‚ "Dispute opened for booking"       â”‚
â”‚ Dispute Resolved           â”‚ Both      â”‚ "Dispute resolved"                 â”‚
â”‚ New Message                â”‚ Recipient â”‚ "New message from [sender]"        â”‚
â”‚ New Review                 â”‚ Host      â”‚ "New review on [listing]"          â”‚
â”‚ KYC Approved               â”‚ Host      â”‚ "Identity verified!"               â”‚
â”‚ KYC Rejected               â”‚ Host      â”‚ "Verification failed"              â”‚
â”‚ Listing Approved           â”‚ Host      â”‚ "[Listing] is now live!"           â”‚
â”‚ Listing Rejected           â”‚ Host      â”‚ "[Listing] was rejected"           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NOTIFICATION STRUCTURE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  userId: "user_123",           // Recipient
  type: "booking",              // Category
  title: "Booking Confirmed!",  // Short title
  message: "Your booking...",   // Full message
  severity: "info",             // info|warning|error|success
  read: false,                  // Read status
  actionRequired: false,        // Needs user action?
  metadata: {
    bookingId: "bk_123",
    link: "/dashboard?tab=bookings"
  }
}


================================================================================
9. HANDSHAKE VERIFICATION PROTOCOL
================================================================================

PURPOSE
â”€â”€â”€â”€â”€â”€â”€
Provides cryptographic proof that guest was granted entry to the property.
This is critical evidence for dispute resolution.

FLOW
â”€â”€â”€â”€

    BOOKING CREATED
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CODES GENERATED                      â”‚
    â”‚                                      â”‚
    â”‚ guestCode: "A3X7K9"  â†â”€â”€ Shown to Guest (in app)
    â”‚ hostCode:  "B2Y8M1"  â†â”€â”€ For host internal use
    â”‚ handshakeStatus: "PENDING"           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ (On arrival day)
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ GUEST ARRIVES                        â”‚
    â”‚                                      â”‚
    â”‚ Guest shows guestCode to Host        â”‚
    â”‚ (displayed in app or QR code)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ HOST VERIFIES                        â”‚
    â”‚                                      â”‚
    â”‚ Option 1: Type code in Host app      â”‚
    â”‚ Option 2: Scan QR code               â”‚
    â”‚                                      â”‚
    â”‚ System calls: verifyHandshake(       â”‚
    â”‚   bookingId,                         â”‚
    â”‚   enteredCode                        â”‚
    â”‚ )                                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ VERIFICATION RESULT                  â”‚
    â”‚                                      â”‚
    â”‚ IF code matches guestCode:           â”‚
    â”‚   âœ“ handshakeStatus = "VERIFIED"     â”‚
    â”‚   âœ“ verifiedAt = timestamp           â”‚
    â”‚   âœ“ status = "Started"               â”‚
    â”‚   âœ“ Entry granted                    â”‚
    â”‚                                      â”‚
    â”‚ IF code doesn't match:               â”‚
    â”‚   âœ— handshakeStatus = "FAILED"       â”‚
    â”‚   âœ— Entry denied                     â”‚
    â”‚   âœ— Investigate potential fraud      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CODE GENERATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Uses crypto.getRandomValues() for security
â€¢ Format: 6 alphanumeric characters (e.g., "A3X7K9")
â€¢ Generated at booking creation time
â€¢ Unique per booking

SECURITY CONSIDERATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Codes are hidden until booking is confirmed
â€¢ Guest code only shown to guest
â€¢ Host code stored for audit purposes
â€¢ Verification timestamp recorded for disputes
â€¢ Failed attempts logged for fraud detection


================================================================================
10. DISPUTE RESOLUTION
================================================================================

WHEN DISPUTES OCCUR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Guest claims they couldn't access property
â€¢ Host claims guest caused damage
â€¢ Guest claims listing was misrepresented
â€¢ Payment/refund disagreements

EVIDENCE AVAILABLE TO ADMIN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Handshake Status
   â€¢ VERIFIED = Strong evidence guest was granted entry
   â€¢ PENDING = No proof of entry
   â€¢ verifiedAt timestamp

2. Transaction History
   â€¢ All payments, refunds, payouts
   â€¢ Timestamps and references

3. Message Thread
   â€¢ Communication between guest and host

4. Audit Log
   â€¢ All security events
   â€¢ Login times, IP addresses

5. Booking Timeline
   â€¢ createdAt, confirmedAt, verifiedAt, completedAt

RESOLUTION OPTIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DECISION: REFUND_GUEST                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Full refund processed to guest                                            â”‚
â”‚ â€¢ Booking status â†’ CANCELLED                                                â”‚
â”‚ â€¢ Funds NOT released to host                                                â”‚
â”‚ â€¢ Both parties notified                                                     â”‚
â”‚ â€¢ Dispute closed                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DECISION: RELEASE_TO_HOST                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Funds released to host                                                    â”‚
â”‚ â€¢ Booking status â†’ COMPLETED                                                â”‚
â”‚ â€¢ Guest refund denied                                                       â”‚
â”‚ â€¢ Both parties notified                                                     â”‚
â”‚ â€¢ Dispute closed                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
11. STATUS TRANSITIONS
================================================================================

BOOKING STATUS STATE MACHINE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           STATUS FLOW               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                 CREATED
                                    â”‚
                                    â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚    PENDING    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
                                    â”‚                                 â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
               â”‚                    â”‚                    â”‚            â”‚
               â–¼                    â–¼                    â–¼            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚    CONFIRMED     â”‚  â”‚   CANCELLED     â”‚  â”‚    RESERVED     â”‚   â”‚
    â”‚                  â”‚  â”‚   (Terminal)    â”‚  â”‚  (Save for      â”‚â”€â”€â”€â”˜
    â”‚ Host accepted    â”‚  â”‚                 â”‚  â”‚   later)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â€¢ Host rejected â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚            â”‚ â€¢ Guest cancel  â”‚
             â”‚            â”‚ â€¢ System expiry â”‚
             â–¼            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     STARTED      â”‚
    â”‚                  â”‚
    â”‚ Handshake OK     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                                  â”‚
             â–¼                                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    COMPLETED     â”‚              â”‚   CANCELLED     â”‚
    â”‚   (Terminal)     â”‚              â”‚   (Terminal)    â”‚
    â”‚                  â”‚              â”‚                 â”‚
    â”‚ Funds released   â”‚              â”‚ Late cancel     â”‚
    â”‚ after 48h        â”‚              â”‚ or dispute      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


VALID TRANSITIONS TABLE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FROM           â”‚ TO (Allowed)                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pending        â”‚ Confirmed, Cancelled                                      â”‚
â”‚ Confirmed      â”‚ Started, Completed, Cancelled                             â”‚
â”‚ Started        â”‚ Completed, Cancelled                                      â”‚
â”‚ Completed      â”‚ (none - terminal state)                                   â”‚
â”‚ Cancelled      â”‚ (none - terminal state)                                   â”‚
â”‚ Reserved       â”‚ Pending, Cancelled                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
12. CONFIGURATION MANAGEMENT
================================================================================

CENTRALIZED CONFIG LOCATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/libs/storage/src/config/appConfig.ts

AUTH_CONFIG
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  MAX_LOGIN_ATTEMPTS: 5,         // Before lockout
  LOCKOUT_DURATION_MINUTES: 15,  // Lockout period
  OTP_EXPIRY_MINUTES: 3,         // OTP valid for
  SESSION_EXPIRY_HOURS: 24,      // Session duration
  ADMIN_EMAILS: ['admin@fiilar.com']
}

BOOKING_CONFIG
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  SERVICE_FEE_PERCENTAGE: 0.10,  // 10% platform fee
  ESCROW_RELEASE_HOURS: 48,      // Hold after completion
  BOOKING_EXPIRY_HOURS: 1,       // Auto-expire pending
  IDEMPOTENCY_KEY_EXPIRY_HOURS: 24,
  MAX_BOOKING_DAYS_AHEAD: 365,   // Max future booking
  MIN_PRICE: 1                   // Minimum booking price
}

CANCELLATION_CONFIG
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  FLEXIBLE: {
    FULL_REFUND_HOURS: 24,
    PENALTY_PERCENT: 0
  },
  MODERATE: {
    FULL_REFUND_DAYS: 5,
    PENALTY_PERCENT: 0
  },
  STRICT: {
    PENALTY_PERCENT: 50
  },
  NON_REFUNDABLE: {
    PENALTY_PERCENT: 100
  }
}

DEMO_CONFIG
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  MOCK_USER_ID: 'user_123',
  MOCK_HOST_ID: 'host_123',
  DEMO_EMAILS: {
    HOST: 'jane@example.com',
    USER: 'john@example.com',
    HOST2: 'sarah@example.com'
  },
  API_DELAY_MS: 500
}


================================================================================
13. DATABASE SCHEMA (localStorage â†’ Backend Migration)
================================================================================

CURRENT STATE (localStorage)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ fiilar_user           â†’ Current logged-in user
â€¢ fiilar_users_db       â†’ All users
â€¢ fiilar_listings       â†’ All listings
â€¢ fiilar_bookings       â†’ All bookings
â€¢ fiilar_escrow_transactions â†’ Payment records
â€¢ fiilar_notifications  â†’ User notifications
â€¢ fiilar_messages       â†’ Chat messages
â€¢ fiilar_conversations  â†’ Chat threads
â€¢ fiilar_reviews        â†’ Reviews
â€¢ fiilar_sessions       â†’ Active sessions
â€¢ fiilar_otp_attempts   â†’ Rate limiting
â€¢ fiilar_audit_log      â†’ Security events

BACKEND MIGRATION (Suggested Schema)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

-- Users Table
CREATE TABLE users (
  id UUID PRIMARY KEY,
  first_name VARCHAR(100),
  last_name VARCHAR(100),
  email VARCHAR(255) UNIQUE NOT NULL,
  phone VARCHAR(20),
  password_hash VARCHAR(255),
  role ENUM('GUEST','USER','HOST','ADMIN'),
  is_host BOOLEAN DEFAULT FALSE,
  wallet_balance DECIMAL(12,2) DEFAULT 0,
  email_verified BOOLEAN DEFAULT FALSE,
  phone_verified BOOLEAN DEFAULT FALSE,
  auth_provider ENUM('email','google','phone'),
  kyc_verified BOOLEAN DEFAULT FALSE,
  kyc_status ENUM('pending','verified','rejected','none'),
  avatar_url TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP
);

-- Listings Table
CREATE TABLE listings (
  id UUID PRIMARY KEY,
  host_id UUID REFERENCES users(id),
  title VARCHAR(255) NOT NULL,
  description TEXT,
  type ENUM('Apartment','Studio','Conference Room',...),
  price DECIMAL(10,2) NOT NULL,
  price_unit ENUM('Hourly','Daily'),
  location VARCHAR(255),
  address VARCHAR(255),
  latitude DECIMAL(10,8),
  longitude DECIMAL(11,8),
  status ENUM('Draft','Pending KYC','Pending Approval','Live','Rejected'),
  capacity INTEGER,
  included_guests INTEGER DEFAULT 1,
  price_per_extra_guest DECIMAL(10,2),
  caution_fee DECIMAL(10,2),
  cancellation_policy ENUM('Flexible','Moderate','Strict','Non-refundable'),
  allow_recurring BOOLEAN DEFAULT TRUE,
  instant_book BOOLEAN DEFAULT FALSE,
  requires_identity_verification BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP
);

-- Bookings Table
CREATE TABLE bookings (
  id UUID PRIMARY KEY,
  listing_id UUID REFERENCES listings(id),
  user_id UUID REFERENCES users(id),
  date DATE NOT NULL,
  duration INTEGER NOT NULL,
  hours INTEGER[], -- For hourly bookings
  booking_type ENUM('Hourly','Daily'),
  total_price DECIMAL(10,2) NOT NULL,
  service_fee DECIMAL(10,2) NOT NULL,
  caution_fee DECIMAL(10,2) DEFAULT 0,
  status ENUM('Pending','Confirmed','Started','Completed','Cancelled','Reserved'),
  guest_count INTEGER DEFAULT 1,
  group_id UUID, -- For recurring bookings
  guest_code VARCHAR(10),
  host_code VARCHAR(10),
  handshake_status ENUM('PENDING','VERIFIED','FAILED'),
  verified_at TIMESTAMP,
  dispute_status ENUM('NONE','OPEN','RESOLVED') DEFAULT 'NONE',
  payment_status ENUM('Pending','Held','Released','Refunded','Paid - Escrow'),
  escrow_release_date TIMESTAMP,
  cancellation_reason TEXT,
  cancelled_at TIMESTAMP,
  cancelled_by UUID,
  modification_allowed BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP
);

-- Transactions Table
CREATE TABLE escrow_transactions (
  id UUID PRIMARY KEY,
  booking_id UUID REFERENCES bookings(id),
  type ENUM('GUEST_PAYMENT','HOST_PAYOUT','REFUND','SERVICE_FEE'),
  amount DECIMAL(10,2) NOT NULL,
  status ENUM('PENDING','COMPLETED','FAILED'),
  paystack_reference VARCHAR(100),
  from_user_id UUID REFERENCES users(id),
  to_user_id UUID REFERENCES users(id),
  metadata JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Notifications Table
CREATE TABLE notifications (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  type VARCHAR(50),
  title VARCHAR(255),
  message TEXT,
  severity ENUM('info','warning','error','success'),
  read BOOLEAN DEFAULT FALSE,
  action_required BOOLEAN DEFAULT FALSE,
  metadata JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Audit Log Table
CREATE TABLE audit_log (
  id UUID PRIMARY KEY,
  action VARCHAR(100) NOT NULL,
  user_id UUID,
  identifier VARCHAR(255),
  success BOOLEAN,
  metadata JSONB,
  ip_address INET,
  user_agent TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_bookings_user ON bookings(user_id);
CREATE INDEX idx_bookings_listing ON bookings(listing_id);
CREATE INDEX idx_bookings_status ON bookings(status);
CREATE INDEX idx_bookings_date ON bookings(date);
CREATE INDEX idx_listings_host ON listings(host_id);
CREATE INDEX idx_listings_status ON listings(status);
CREATE INDEX idx_notifications_user ON notifications(user_id, read);
CREATE INDEX idx_transactions_booking ON escrow_transactions(booking_id);


================================================================================
14. ERROR HANDLING
================================================================================

ERROR CATEGORIES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Category               â”‚ Handling                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Validation Errors      â”‚ Return { success: false, error: message }        â”‚
â”‚                        â”‚ Show toast to user                               â”‚
â”‚                        â”‚ Log to audit if security-related                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Security Errors        â”‚ Return { securityError: true }                   â”‚
â”‚                        â”‚ Log to audit with full details                   â”‚
â”‚                        â”‚ Block operation                                  â”‚
â”‚                        â”‚ Consider rate limiting                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Payment Errors         â”‚ Retry with exponential backoff                   â”‚
â”‚                        â”‚ Notify user of failure                           â”‚
â”‚                        â”‚ Log transaction attempt                          â”‚
â”‚                        â”‚ Admin alert for repeated failures                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Network Errors         â”‚ Show offline indicator                           â”‚
â”‚                        â”‚ Queue operations for retry                       â”‚
â”‚                        â”‚ Local storage fallback                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Unexpected Errors      â”‚ ErrorBoundary catches React errors               â”‚
â”‚                        â”‚ console.error for debugging                      â”‚
â”‚                        â”‚ User-friendly error message                      â”‚
â”‚                        â”‚ Option to reload/retry                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

BOOKING ERROR RESPONSES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

{
  success: false,
  error: "Price validation failed: Total mismatch",
  securityError: true
}

{
  success: false,
  error: "A booking for this date/time already exists",
  securityError: true
}

{
  success: false,
  error: "The following hours are already booked: 14, 15",
  securityError: true
}

{
  success: false,
  error: "Invalid status transition from Completed to Pending",
  securityError: false
}


================================================================================
15. FUTURE CONSIDERATIONS
================================================================================

RECOMMENDED ENHANCEMENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. REAL PAYMENT INTEGRATION
   â€¢ Paystack/Stripe integration for real transactions
   â€¢ Webhook handlers for payment status updates
   â€¢ Virtual account generation for each host

2. REAL-TIME FEATURES
   â€¢ WebSocket for instant notifications
   â€¢ Live availability updates
   â€¢ Chat message delivery status

3. ADVANCED VERIFICATION
   â€¢ Dojah integration for KYC
   â€¢ Liveness detection
   â€¢ Bank account verification

4. ANALYTICS
   â€¢ Host earnings dashboard
   â€¢ Booking conversion rates
   â€¢ Popular time slots
   â€¢ Revenue forecasting

5. MOBILE APP
   â€¢ React Native version
   â€¢ Push notifications
   â€¢ QR code scanning for handshake

6. SCALABILITY
   â€¢ Move from localStorage to PostgreSQL/MongoDB
   â€¢ Redis for session caching
   â€¢ Microservices architecture
   â€¢ CDN for images

7. COMPLIANCE
   â€¢ GDPR data handling
   â€¢ Tax reporting integration
   â€¢ Legal document management
   â€¢ Audit trail retention policy


================================================================================
                              END OF DOCUMENT
================================================================================
                        Generated: November 27, 2025
                        For: Fiilar Booking Platform
================================================================================
